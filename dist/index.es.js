import{createContext as e,createElement as n,useEffect as o,useState as t,Fragment as r,useContext as i,useRef as a,createRef as l}from"react";import c from"prop-types";import{useWindowSize as s}from"@react-hook/window-size";import{isMobile as d}from"react-device-detect";import{Rnd as u}from"react-rnd";import m from"react-textarea-autosize";import p from"react-loader-spinner";import"react-loader-spinner/dist/loader/css/react-spinner-loader.css";
/*! *****************************************************************************
Copyright (c) Microsoft Corporation. All rights reserved.
Licensed under the Apache License, Version 2.0 (the "License"); you may not use
this file except in compliance with the License. You may obtain a copy of the
License at http://www.apache.org/licenses/LICENSE-2.0

THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
MERCHANTABLITY OR NON-INFRINGEMENT.

See the Apache Version 2.0 License for specific language governing permissions
and limitations under the License.
***************************************************************************** */var f=function(){return(f=Object.assign||function(e){for(var n,o=1,t=arguments.length;o<t;o++)for(var r in n=arguments[o])Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r]);return e}).apply(this,arguments)};function _(e,n){var o,t,r,i,a={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return i={next:l(0),throw:l(1),return:l(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function l(i){return function(l){return function(i){if(o)throw new TypeError("Generator is already executing.");for(;a;)try{if(o=1,t&&(r=2&i[0]?t.return:i[0]?t.throw||((r=t.return)&&r.call(t),0):t.next)&&!(r=r.call(t,i[1])).done)return r;switch(t=0,r&&(i=[2&i[0],r.value]),i[0]){case 0:case 1:r=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,t=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(r=a.trys,(r=r.length>0&&r[r.length-1])||6!==i[0]&&2!==i[0])){a=0;continue}if(3===i[0]&&(!r||i[1]>r[0]&&i[1]<r[3])){a.label=i[1];break}if(6===i[0]&&a.label<r[1]){a.label=r[1],r=i;break}if(r&&a.label<r[2]){a.label=r[2],a.ops.push(i);break}r[2]&&a.ops.pop(),a.trys.pop();continue}i=n.call(e,a)}catch(e){i=[6,e],t=0}finally{o=r=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,l])}}}!function(e,n){void 0===n&&(n={});var o=n.insertAt;if(e&&"undefined"!=typeof document){var t=document.head||document.getElementsByTagName("head")[0],r=document.createElement("style");r.type="text/css","top"===o&&t.firstChild?t.insertBefore(r,t.firstChild):t.appendChild(r),r.styleSheet?r.styleSheet.cssText=e:r.appendChild(document.createTextNode(e))}}('@import url("https://fonts.googleapis.com/css?family=Source+Code+Pro&display=swap");\n#index_terminalContainer__3q4m3 {\n  --control-default-bg-color: #ccc;\n  --control-close-bg-color: #fc5b57;\n  --control-minimize-bg-color: #e5bf3c;\n  --control-maximize-bg-color: #57c038; }\n\n.index_controls__9z-dM {\n  display: "block";\n  text-align: left;\n  height: 26px;\n  position: relative;\n  top: 4px;\n  margin-left: 4px; }\n  .index_controls__9z-dM .index_consoleCtrl__PQnAL {\n    display: inline-block;\n    width: 13px;\n    height: 13px;\n    margin: 0 3px;\n    border-radius: 50%;\n    background: var(--control-default-bg-color); }\n  .index_controls__9z-dM .index_close__2o6CK {\n    background: var(--control-close-bg-color); }\n  .index_controls__9z-dM .index_minimize__E9mwB {\n    background: var(--control-minimize-bg-color); }\n  .index_controls__9z-dM .index_maximize__sbbYF {\n    background: var(--control-maximize-bg-color); }\n\n.index_editor__2tqRz {\n  text-align: left;\n  height: calc(100% - 46px);\n  padding: 10px 15px;\n  overflow-wrap: break-word;\n  overflow-y: scroll;\n  outline: none;\n  font-family: "Source Code Pro", monospace;\n  font-size: 18px;\n  line-height: 22px;\n  border-bottom-left-radius: 5px;\n  border-bottom-right-radius: 5px; }\n  .index_editor__2tqRz .index_textbox__Wb3j1 {\n    font-family: "Source Code Pro", monospace;\n    font-size: 18px;\n    border: none; }\n  .index_editor__2tqRz .index_loader__3l44g {\n    text-align: center; }\n  .index_editor__2tqRz .index_mobileInput__jGtyc {\n    position: absolute;\n    top: -2000px;\n    left: -2000px; }\n  .index_editor__2tqRz .index_lineText__2Poex {\n    display: inline;\n    position: relative;\n    top: -1px;\n    margin-left: 8px; }\n  .index_editor__2tqRz .index_preWhiteSpace__3nCT2 {\n    white-space: pre; }\n  .index_editor__2tqRz .index_caret__MYxcn {\n    position: relative;\n    -webkit-animation: index_blink__RQDX- 0.75s ease-in-out infinite;\n    -moz-animation: index_blink__RQDX- 0.75s ease-in-out infinite;\n    -o-animation: index_blink__RQDX- 0.75s ease-in-out infinite;\n    -ms-animation: index_blink__RQDX- 0.75s ease-in-out infinite;\n    animation: index_blink__RQDX- 0.75s ease-in-out infinite; }\n    .index_editor__2tqRz .index_caret__MYxcn .index_caretAfter__2B8sk {\n      content: "";\n      position: absolute;\n      top: 2px;\n      width: 10px;\n      height: 22px;\n      z-index: 10; }\n\n@-moz-keyframes index_blink__RQDX- {\n  0% {\n    opacity: 0;\n    -ms-filter: "progid:DXImageTransform.Microsoft.Alpha(Opacity=0)";\n    filter: alpha(opacity=0); }\n  100% {\n    opacity: 1;\n    -ms-filter: none;\n    filter: none; } }\n\n@-webkit-keyframes index_blink__RQDX- {\n  0% {\n    opacity: 0;\n    -ms-filter: "progid:DXImageTransform.Microsoft.Alpha(Opacity=0)";\n    filter: alpha(opacity=0); }\n  100% {\n    opacity: 1;\n    -ms-filter: none;\n    filter: none; } }\n\n@-o-keyframes index_blink__RQDX- {\n  0% {\n    opacity: 0;\n    -ms-filter: "progid:DXImageTransform.Microsoft.Alpha(Opacity=0)";\n    filter: alpha(opacity=0); }\n  100% {\n    opacity: 1;\n    -ms-filter: none;\n    filter: none; } }\n\n@keyframes index_blink__RQDX- {\n  0% {\n    opacity: 0;\n    -ms-filter: "progid:DXImageTransform.Microsoft.Alpha(Opacity=0)";\n    filter: alpha(opacity=0); }\n  100% {\n    opacity: 1;\n    -ms-filter: none;\n    filter: none; } }\n  .index_editor__2tqRz a {\n    color: #1a87b5; }\n\n#index_terminalContainer__3q4m3 {\n  height: 100%; }\n\n.index_terminal__1dSq1 {\n  height: 100%;\n  width: 100%;\n  margin: auto;\n  border-radius: 5px; }\n');var h={terminalContainer:"index_terminalContainer__3q4m3",controls:"index_controls__9z-dM",consoleCtrl:"index_consoleCtrl__PQnAL",close:"index_close__2o6CK",minimize:"index_minimize__E9mwB",maximize:"index_maximize__sbbYF",editor:"index_editor__2tqRz",textbox:"index_textbox__Wb3j1",loader:"index_loader__3l44g",mobileInput:"index_mobileInput__jGtyc",lineText:"index_lineText__2Poex",preWhiteSpace:"index_preWhiteSpace__3nCT2",caret:"index_caret__MYxcn",blink:"index_blink__RQDX-",caretAfter:"index_caretAfter__2B8sk",terminal:"index_terminal__1dSq1"},x=e(null),b=function(e){var o=e.children;return n(x.Provider,{value:h},o)},g={dark:{themeBGColor:"#022833",themeToolbarColor:"#131519",themeColor:"#839496",themePromptColor:"#a917a8"},light:{themeBGColor:"#fdf6e4",themeToolbarColor:"#d8d8d8",themeColor:"#333333",themePromptColor:"#a917a8"},dracula:{themeBGColor:"#272B36",themeToolbarColor:"#DBDBDB",themeColor:"#FFFEFC",themePromptColor:"#a917a8"}},v=e(null),y=function(e){var o=e.children,t=f(f({},g),o.props.themes||{}),r=t[o.props.theme]||t.light;return n(v.Provider,{value:r},o)},C=e(null);function w(e){var o=i(C),t=o.editorInput,r=o.setEditorInput,a=i(x),l=e.showControlButtons,c=e.controlButtonLabels,s=e.maximize,d=e.minimize,u=l?c.map((function(e){return n("a",{onClick:function(){return function(e){"maximize"===e?s():"minimize"===e?d():"close"===e&&r(t+"cheese")}(e)},key:e,className:a.consoleCtrl+" "+a[e]})})):null;return n("div",{className:a.controls},u)}var k=function(e,t,a,l,c,s){var d=i(C),u=d.bufferedContent,m=d.setBufferedContent,p=i(v);o((function(){if(t){var o,i,d,f,h;o=l,i=void 0,d=void 0,h=function(){var t;return _(this,(function(i){return""===o?(t=n(r,null,n("span",{style:{color:p.themePromptColor}}," ",e," ")," ",n("br",null)),m(n(r,null,u,t)),c(""),a(!1)):"clear"===o?(m(""),c(""),a(!1),s&&s(o)):(c(""),s&&s(o)),[2]}))},new((f=void 0)||(f=Promise))((function(e,n){function o(e){try{r(h.next(e))}catch(e){n(e)}}function t(e){try{r(h.throw(e))}catch(e){n(e)}}function r(n){n.done?e(n.value):new f((function(e){e(n.value)})).then(o,t)}r((h=h.apply(i,d||[])).next())}))}}),[t])},z=function(e,l,c,s,u,p){var f=i(x),_=i(v),h=i(C),b=h.editorInput,g=h.setEditorInput,y=h.appendCommandToHistory,w=a(null),z=t(!1),T=z[0],B=z[1];o((function(){d&&l&&w.current.focus()}),[l]),o((function(){T&&y(b)}),[T]);d&&s&&n("div",{className:f.mobileInput},n("input",{type:"text",autoComplete:"off",autoCorrect:"off",autoCapitalize:"off",spellCheck:"false",value:b,onChange:function(e){return g(e.target.value)},ref:w}));var P=T?n(r,null,n("div",{className:f.lineText},l&&e?n("span",{className:f.caret},n("span",{className:f.caretAfter,style:{background:_.themeColor}})):null)):n("div",{style:{flex:1,flexDirection:"row"}},n("span",{style:{color:_.themePromptColor,verticalAlign:"top"}},c),n("div",{className:f.lineText},n(m,{autoFocus:!0,autoComplete:"off",autoCorrect:"off",autoCapitalize:"off",spellCheck:"false",value:b,className:f.textbox,style:{backgroundColor:_.themeBGColor,width:"80%",color:"white",border:"none",outline:"none",resize:"none"},minRows:1,maxRows:10,onChange:function(e){return g(e.target.value)},onKeyDown:function(e){"Enter"===e.key&&B(!0)}})));return k(c,T,B,b,g,u),function(e,n){o((function(){n(!!e)}),[e])}(p,B),P};function T(e){var t=a(null),l=i(x),c=i(v),s=i(C).bufferedContent;!function(e,n){o((function(){n.current.scrollTop=n.current.scrollHeight}),[e])}(s,t);var d=e.isLoading,u=e.enableInput,m=e.welcomeMessage,f=e.caret,_=e.consoleFocused,h=e.prompt,b=e.commandPassThrough,g=e.blockInput,y=z(f,_,h,u,b,g);return n("div",{ref:t,className:l.editor,style:{background:c.themeBGColor}},d?n("div",{className:l.loader},n(p,{type:"TailSpin",color:"white",width:75,height:75})):n(r,null,m,s,y))}function B(e){var c,m,p,f,_=a(null),h=t(!d),b=h[0],g=h[1],y=i(x),C=i(v);c=_,m=b,p=g,f=function(e){c.current&&!c.current.contains(e.target)?p(!1):p(!d||!m)},o((function(){return document.addEventListener("mousedown",f),function(){document.removeEventListener("mousedown",f)}}));var k=e.draggable,z=e.commandPassThrough,B=e.blockInput,P=e.isLoading,I=e.caret,M=e.theme,R=e.showControlButtons,D=e.controlButtonLabels,N=e.prompt,L=e.commands,q=e.welcomeMessage,S=e.errorMessage,X=e.enableInput,A=l(),E=s(),F=function(){A.current&&A.current.updateSize({width:500,height:200})},Q=function(){var e=E[0],n=E[1];A.current&&A.current.updateSize({width:e,height:n})};return n(r,null,k?n(u,{ref:A,default:{x:150,y:205,width:500,height:200},minWidth:500,minHeight:200,bounds:"window",cancel:".cancel"},n("div",{ref:_,id:y.terminalContainer,className:""+y["theme--"+M]},n("div",{className:""+y.terminal,style:{background:C.themeToolbarColor,color:C.themeColor}},n(w,{minimize:F,maximize:Q,consoleFocused:b,showControlButtons:R,controlButtonLabels:D}),n("div",{className:"cancel",style:{width:"100%",height:"100%"}},n(T,{commandPassThrough:z,blockInput:B,isLoading:P,caret:I,consoleFocused:b,prompt:N,commands:L,welcomeMessage:q,errorMessage:S,enableInput:X}))))):n("div",{ref:_,id:y.terminalContainer,className:""+y["theme--"+M]},n("div",{className:""+y.terminal,style:{background:C.themeToolbarColor,color:C.themeColor}},n(w,{minimize:F,maximize:Q,consoleFocused:b,showControlButtons:R,controlButtonLabels:D}),n("div",{className:"cancel",style:{width:"100%",height:"100%"}},n(T,{commandPassThrough:z,blockInput:B,isLoading:P,caret:I,consoleFocused:b,prompt:N,commands:L,welcomeMessage:q,errorMessage:S,enableInput:X})))))}function P(e){var o=e.children;return n(b,null,n(y,null,o))}function I(e){return n(P,null,n(B,f({},e)))}B.propTypes={draggable:c.bool,commandPassThrough:c.func,blockInput:c.bool,isLoading:c.bool,enableInput:c.bool,caret:c.bool,theme:c.string,showControlButtons:c.bool,controlButtonLabels:c.arrayOf(c.string),prompt:c.string,commands:c.objectOf(c.oneOfType([c.string,c.func,c.node])),welcomeMessage:c.oneOfType([c.string,c.func,c.node]),errorMessage:c.string},B.defaultProps={draggable:!1,commandPassThrough:null,blockInput:!1,isLoading:!1,enableInput:!0,caret:!0,theme:"light",showControlButtons:!0,controlButtonLabels:["close","minimize","maximize"],prompt:">>>",commands:{},welcomeMessage:"",errorMessage:"not found!"};var M=function(e){var i=e.children,a=t(""),l=a[0],c=a[1],s=t(n(r,null)),d=s[0],u=s[1],m=t([]),p=m[0],f=m[1],_=t(null),h=_[0],x=_[1];o((function(){x(p.length)}),[p]);return n(C.Provider,{value:{editorInput:l,setEditorInput:c,bufferedContent:d,setBufferedContent:u,appendCommandToHistory:function(e){e&&f(p.concat(e))},getPreviousCommand:function(){if(0===h)return 0===p.length?"":p[0];var e=p[h-1];return h>0&&x(h-1),e},getNextCommand:function(){if(h+1<=p.length){if(h===p.length)return"";var e=p[h+1];return x(h+1),e}return""}}},i)},R=C,D={ReactTerminal:I,TerminalContextProvider:M};export default D;export{I as ReactTerminal,R as TerminalContext,M as TerminalContextProvider};
